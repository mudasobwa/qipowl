<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Typogrowl for HTML</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 50px;
                padding-bottom: 20px;
            }
            table.mapping {
                font: 9px monospace;
            }
            table.mapping thead {
                font-size: 12px;
                font-weight: bold;
            }
            div#syntaxresultdiv {
                overflow-y: scroll;
                height: 150px;
            }
            div#result {
                overflow-y: scroll;
            }
            div#result, textarea#text {
                height: 500px;
            }
        </style>
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
        
        <script>
            function parseIt() {
              $.get( "/html/parse", { text: $('#text').val() } )
                .done(function( data ) {
                  $('#result').html (data)
                });
            }
            function deleteMappingKey(key) {
              $.ajax({
                url: '/html/mapping/' + key,
                type: 'DELETE',
                success: function(result) {
                  fillMapping();
                  parseIt();
                }
              });
            }
            function addMappingKey(section,key,value,enclosure) {
              $.ajax({
                url: '/html/mapping/' + section + '/' + key + '/' + value + '/' + enclosure,
                type: 'PUT',
                success: function(result) {
                  fillMapping();
                  parseIt();
                }
              });
            }
            function fillMapping() {
              $("#syntaxrules").empty();
              $("#syntaxrules").append("<br><div id='syntaxrulesdiv' class='tab-content'></div>");
              $.getJSON( "/html/mapping", { } )
                .done(function( data ) {
                  var tabs = ["<li class='active'><a href='#mapping-show-hide' data-toggle='tab'>extend syntax</a></li>"];
                  var control =
                    '<form id="newmapping" class="form-inline" role="form">' + 
                    '  <div class="form-group">' + 
                    '    <label class="sr-only" for="mapping-new-key">Key to add</label>' + 
                    '    <input class="form-control" id="mapping-new-key" name="key" placeholder="Key (e.g., “×”)">' + 
                    '  </div>' + 
                    '  <div class="form-group">' + 
                    '    <label class="sr-only" for="mapping-new-value">Value for key</label>' + 
                    '    <input class="form-control" id="mapping-new-value" name="value" placeholder="Value for key">' + 
                    '  </div>' + 
                    '  <div class="form-group">' + 
                    '    <label class="sr-only" for="mapping-new-enclosure">Enclosure for key</label>' + 
                    '    <input class="form-control" id="mapping-new-enclosure" name="enclosure" placeholder="Enclosure">' + 
                    '  </div>' + 
                    '  <div class="form-group">' + 
                    '    <select class="form-control" id="mapping-new-section" name="section">' + 
                    '      <option>' + 'flush' + '</option>' + 
                    '      <option>' + 'block' + '</option>' + 
                    '      <option>' + 'magnet' + '</option>' + 
                    '      <option>' + 'inplace' + '</option>' + 
                    '      <option>' + 'linewide' + '</option>' + 
                    '      <option>' + 'custom' + '</option>' + 
                    '    </select>' + 
                    '  </div>' + 
                    '  <div class="form-group">' + 
                    '    <button type="submit" class="btn btn-submit">Add!</button>' +
                    '  </div>' + 
                    '</form>';
                  var divs = ["<div class='tab-pane fade active in' id='mapping-show-hide'><br>" + control + "</div>"];
                  $.each( data, function( key, val ) {
                    tabs.push( "<li><a href='#" + key + "' data-toggle='tab'>" + key + "</a></li>" );
                    var div = "<div class='tab-pane fade' id='" + key + "'>" +
                          "<table class='table table-condensed table-striped mapping' id='" + key + "-table'>" +
                          "<thead><tr><td width='40%'>Key</td><td width='40%'>Value</td><td>Action</td></tr></thead><tbody>";
                    $.each( val, function( k, v ) {
                      if (!(typeof v === 'string')) {
                        v = JSON.stringify(v);
                      }
                      v = v.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
                      delBtn = "<a href='javascript:deleteMappingKey(\"" + k + "\")' class='btn btn-primary btn-xs' role='button'>—</a>";
                      div += "<tr><td>" + k + "</td><td>" + v + "</td><td>" + delBtn + "</td></tr>"
                    });
                    div += "</tbody></table></div>";
                    divs.push(div)
                  });
                  $( "<ul/>", {
                    "class": "nav nav-tabs",
                    "id": "syntaxresultul",
                    html: tabs.join( "" )
                  }).appendTo( "#syntaxrules" );
                  $( "<div/>", {
                    "class": "tab-content",
                    "id": "syntaxresultdiv",
                    html: divs.join( "" )
                  }).appendTo( "#syntaxrules" );
                  $( "#newmapping" ).submit(function(event) {
                    event.preventDefault();

                    var $form = $(this),
                        key = $form.find('input[name="key"]').val(),
                        value = $form.find('input[name="value"]').val(),
                        enclosure = $form.find('input[name="enclosure"]').val(),
                        section = $form.find('select[name="section"]').val()
                    addMappingKey(section,key,value,enclosure);
                  })
                });
            }
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Typogrowl Demo</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="http://github.com/mudasobwa/typogrowl">Source</a></li>
            <li class="active"><a href="#">HTML</a></li>
            <!--li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li-->
          </ul>
          <!--form class="navbar-form navbar-right">
            <div class="form-group">
              <input type="text" placeholder="Email" class="form-control">
            </div>
            <div class="form-group">
              <input type="password" placeholder="Password" class="form-control">
            </div>
            <button type="submit" class="btn btn-success">Sign in</button>
          </form-->
        </div><!--/.navbar-collapse -->
      </div>
    </div>

    <div class="container" id="syntaxrules"> </div>

    <hr>
        
    <div class="container">
      <!-- Example row of columns -->
      <div class="row">
        <div class="col-lg-6">
          <h2>Input text here:</h2>
          <textarea style="margin-bottom:0.2em;" type="text" rows="21" id="text" name="text" class="form-control">
§1 Welcome!

Typogrowl ≈helps≈ you to ≡format rich≡ using plain text. This para is, for instance, the leading one in terms of bootstrap ( `class='lead'`).

¶ This is a text with typogrowl markup. 

• unbulleted lists:
 • nice
 • handy
• ordered lists are as well.

★ Feel free to test:
▷ bulleted lists — with “•” symbol
▷ data lists — with “▶”
▷ blockquotes — with “〉” and nesteds
▷ links — with “ ¹” and other human readables

§3 Even bootstrap classes are available:

• “☆” for “muted” text as well as descendants:
 • “★” for “primary” text
 • “☛” for “success” text
 • “☞” for “info” text
• “☣” for “warning” text
• “☢” for “danger” text

✎ 
Comments are visible in HTML source only
✎

Hope you’ll enjoy!
          </textarea>
          <button type="submit" onclick="parseIt();" class="btn btn-success">Submit!</button>
        </div>
        <div class="col-lg-6">
          <h2>Result:</h2>
          <div id="result" style="padding:1em; border:1px solid #ddd;"></div>
       </div>
      </div>

      <hr>

      <footer>
        <p>© 2013; Mudasobwa</p>
      </footer>
    </div> <!-- /container -->        
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.1.min.js"><\/script>')</script>

        <script src="js/vendor/bootstrap.min.js"></script>

        <script src="js/main.js"></script>

        <!--script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src='//www.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script-->
        <script>
            $( document ).ready( function() { fillMapping(); parseIt(); } )
        </script>

    </body>
</html>
